---
title: 《高性能MySQL》笔记 - MySQL 锁的基本类型
date: 2017-10-06 15:53:58
top: 97
tags: 
- MySQl
- 高并发
- 数据库锁
categories: MySQL
---
### MySQL 主要在两个层面上实现并发控制：服务器层和存储引擎层。

当读写有冲突的时候，一般对于MySQL来说，是进行锁表操作的。

### 读写锁
读锁：读锁是共享的，多个用户同一时刻读取同一资源，他们之前互不影响。

写锁：写锁则是排他的，也就是说一个写锁会阻塞其他的写锁和读锁，这是出于安全策略的考虑，只有这样，才能确保在给定的时间里，只有一个用户能执行写入，并防止其他用户读取正在写入的同一资源。

### 锁粒度

一种提高共享资源的并发性的方式就是让锁定的对象更有选择性。尽量只锁定需要修改的部分数据，而不是所有资源。更加理想的方式是，只对会修改的数据片进行精确的锁定。任何时候，在给定的资源上，锁定的数据量越少，则系统的并发程度越高，只要相互之间不发生冲突即可。

但是，所有的锁都是需要消耗资源的。锁的各种操作，包括获得锁，检查锁是否已经解除，释放锁等，都会增加系统的开销。

这里我们可以意识到：所谓的锁策略，是在锁的开销和数据的安全之间寻求平衡，这种平衡会影响到性能。

#### 表锁

表锁是MySQL中的基本策略，并且是开销最小的策略。当一个用户在对表进行操作(CUD)前，需要先获得写锁，这会阻塞其他用户对该表的所有操作。只有没有写锁时，其他读取用户才能获得读锁，读锁之间互不阻塞。

#### 行锁

行级锁可以最大程度的支持并发处理(同时也带来了最大的锁开销)。
    
   


